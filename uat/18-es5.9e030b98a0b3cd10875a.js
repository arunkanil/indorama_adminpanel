!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function a(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{eFNz:function(e,o,n){"use strict";n.r(o),n.d(o,"IndoramaUpdatesModule",function(){return B});var s=n("SVse"),r=n("s7LF"),d=n("FE24"),l=n("2ZVE"),c=n("YFAK"),u=n("LqlI"),b=n("iInd"),h=n("R7Hv"),p=n("7nfi"),g=n("AytR"),f=n("8Y7J"),m=n("EApP"),v=["cropPriceModal"],w=["detailsModal"],y=["deleteModal"];function S(t,e){if(1&t&&f.Nb(0,"img",40),2&t){var i=f.cc();f.kc("src",i.imageUrl,f.xc)}}function R(t,e){1&t&&f.Nb(0,"span",41)}var A,U,k,D=[{path:"",children:[{path:"",redirectTo:"cropprices"},{path:"all",component:(A=function(){function e(o,a,n,s){i(this,e),this.dataservice=o,this.router=a,this.fb=n,this.toastr=s,this.baseURL=g.a.apiUrl,this.loading=!0,this.btnLoading=!1,this.disableButton=!0,this.disableNextButton=!1,this.disablePrevButton=!0,this.pageSize=20,this.from=1,this.to=20,this.count=1,this.orders={},this.columnDefs=[],this.newsForm=this.fb.group({Title:["",r.s.required],Body:["",r.s.required],Image:[""]}),this.rowData=[],this.selectedRows=[],this.selectedYear=(new Date).getFullYear(),this.years=[],this.filter={},this.file=null,this.columnDefs=t(p.g),this.rowSelection="single"}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,console.log(this.router),this.getUpdates(void 0,1,this.pageSize)}},{key:"getUpdates",value:function(t,e,i){var o=this;this.dataservice.getIndoramaUpdates(t,e,i).valueChanges.subscribe(function(t){var e,i,a,n,s,r;o.rowData=t.data.newsAndUpdates.data,o.meta=t.data.newsAndUpdates.meta,(null===(i=null===(e=o.meta)||void 0===e?void 0:e.pagination)||void 0===i?void 0:i.pageCount)<=1&&(o.disablePrevButton=!0,o.disableNextButton=!0),(null===(n=null===(a=o.meta)||void 0===a?void 0:a.pagination)||void 0===n?void 0:n.total)<o.pageSize&&(o.to=null===(r=null===(s=o.meta)||void 0===s?void 0:s.pagination)||void 0===r?void 0:r.total)})}},{key:"loadNext",value:function(){var t,e,i,o,a=this;this.count++,this.disablePrevButton=!1,this.from=this.from+this.pageSize,this.to=this.to+this.pageSize>(null===(e=null===(t=this.meta)||void 0===t?void 0:t.pagination)||void 0===e?void 0:e.total)?null===(o=null===(i=this.meta)||void 0===i?void 0:i.pagination)||void 0===o?void 0:o.total:this.to+this.pageSize,this.count===this.meta.pagination.pageCount&&(this.disableNextButton=!0),this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(t){a.meta=t.data.newsAndUpdates.meta,a.rowData=t.data.newsAndUpdates.data})}},{key:"loadPrev",value:function(){var t=this;this.count--,this.count<this.meta.pagination.pageCount&&(this.disableNextButton=!1),1===this.count&&(this.disablePrevButton=!0),this.from=this.from-this.pageSize,this.to=this.to-this.rowData.length,this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(e){t.meta=e.data.newsAndUpdates.meta,t.rowData=e.data.newsAndUpdates.data})}},{key:"onGridReady",value:function(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.gridApi.sizeColumnsToFit()}},{key:"onRowClicked",value:function(t){console.log("row",t.data)}},{key:"onSelectionChanged",value:function(t){this.selectedRows=this.gridApi.getSelectedRows(),this.disableButton=!(this.selectedRows.length>0)}},{key:"onChange",value:function(t){this.file=[];for(var e=0;e<t.target.files.length;e++)this.file.push(t.target.files[e])}},{key:"openModal",value:function(t){var e,i,o,a,n,s,d,l;this.imageUrl=null,this.cropPriceModal.show(),t?(this.newsForm=this.fb.group({Title:[this.selectedRows[0].attributes.Title,r.s.required],Body:[this.selectedRows[0].attributes.Body,r.s.required],Image:[null===(i=null===(e=this.selectedRows[0].attributes.Images)||void 0===e?void 0:e.data[0])||void 0===i?void 0:i.id,r.s.required]}),this.imageUrl=(null===(n=null===(a=null===(o=this.selectedRows[0].attributes.Images)||void 0===o?void 0:o.data[0])||void 0===a?void 0:a.attributes)||void 0===n?void 0:n.url)?"".concat(this.baseURL)+(null===(l=null===(d=null===(s=this.selectedRows[0].attributes.Images)||void 0===s?void 0:s.data[0])||void 0===d?void 0:d.attributes)||void 0===l?void 0:l.url):null):(this.newsForm=this.fb.group({Title:["",r.s.required],Body:["",r.s.required],Image:["",r.s.required]}),this.imageUrl=null)}},{key:"deleteRecord",value:function(){var t=this;this.dataservice.UpdateIndoramaUpdates({isDelete:!0},this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.getUpdates(),t.file=null,t.deleteModal.hide(),t.gridApi.deselectAll()):t.toastr.error("Failed. Please check the fields!")})}},{key:"cropPriceSubmit",value:function(){var t=this;this.btnLoading=!0,console.log(this.newsForm.value),this.disableButton?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status?(console.log(e),t.dataservice.AddIndoramaUpdates(t.newsForm.value,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.createNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.cropPriceModal.hide(),t.newsForm.reset(),t.btnLoading=!1,t.getUpdates(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})):(t.toastr.error("Image failed to upload!"),t.btnLoading=!1)}):this.file?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status&&(console.log(e),t.dataservice.UpdateIndoramaUpdates(t.newsForm.value,t.selectedRows[0].id,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.getUpdates(),t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)}))}):this.dataservice.UpdateIndoramaUpdates(this.newsForm.value,this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll(),t.getUpdates()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})}}]),e}(),A.\u0275fac=function(t){return new(t||A)(f.Mb(h.a),f.Mb(b.c),f.Mb(r.c),f.Mb(m.b))},A.\u0275cmp=f.Gb({type:A,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(f.Ic(v,1),f.Ic(w,1),f.Ic(y,1)),2&t&&(f.rc(i=f.ac())&&(e.cropPriceModal=i.first),f.rc(i=f.ac())&&(e.detailsModal=i.first),f.rc(i=f.ac())&&(e.deleteModal=i.first))},decls:67,vars:17,consts:[[1,"animated","fadeIn"],[1,"card"],[1,"card-header",2,"display","flex","justify-content","space-between"],["type","button","data-toggle","modal",1,"btn","btn-danger",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-info",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-primary",3,"disabled","click"],[1,"card-body"],[1,"row"],[1,"col-12"],["id","myGrid","animateRows","true",1,"ag-theme-alpine",2,"width","100%","height","65vh",3,"columnDefs","rowData","rowSelection","selectionChanged","gridReady"],["agGrid",""],[1,"float-left","mt-3"],["type","button",1,"btn","btn-primary","float-right","m-2",3,"disabled","click"],[1,"float-right","mt-3"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],["cropPriceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","Title"],["type","text","id","Title","name","Title","formControlName","Title","placeholder","Enter title",1,"form-control"],["for","Body"],["id","Body","rows","5","name","Body","formControlName","Body","placeholder","Enter Body",1,"form-control"],["for","Image"],["width","100","height","100","style","object-fit: cover",3,"src",4,"ngIf"],["type","file","id","Image","accept",".jpg,.jpeg,.JPEG,.png","name","Image","formControlName","Image","placeholder","Choose image",1,"form-control",3,"change"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["deleteModal","bs-modal"],[1,"modal-dialog","modal-dialog-centered","modal-sm"],[1,"modal-body","text-center"],[1,"modal-footer","justify-content-around"],["type","button",1,"btn","btn-primary",3,"click"],["width","100","height","100",2,"object-fit","cover",3,"src"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(t,e){if(1&t){var i=f.Tb();f.Sb(0,"div",0),f.Sb(1,"div",1),f.Sb(2,"div",2),f.Sb(3,"h2"),f.Dc(4,"Indorama Updates"),f.Rb(),f.Sb(5,"div"),f.Sb(6,"button",3),f.Zb("click",function(){return f.vc(i),f.sc(57).show()}),f.Dc(7," Delete "),f.Rb(),f.Sb(8,"button",4),f.Zb("click",function(){return e.openModal("Edit")}),f.Dc(9," Edit "),f.Rb(),f.Sb(10,"button",5),f.Zb("click",function(){return e.openModal()}),f.Dc(11," Add New Update "),f.Rb(),f.Rb(),f.Rb(),f.Sb(12,"div",6),f.Sb(13,"div",7),f.Sb(14,"div",8),f.Sb(15,"ag-grid-angular",9,10),f.Zb("selectionChanged",function(t){return e.onSelectionChanged(t)})("gridReady",function(t){return e.onGridReady(t)}),f.Rb(),f.Sb(17,"span",11),f.Dc(18),f.Rb(),f.Sb(19,"button",12),f.Zb("click",function(){return e.loadNext()}),f.Dc(20," Next "),f.Rb(),f.Sb(21,"span",13),f.Dc(22),f.Rb(),f.Sb(23,"button",12),f.Zb("click",function(){return e.loadPrev()}),f.Dc(24," Prev "),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Sb(25,"div",14,15),f.Sb(27,"div",16),f.Sb(28,"div",17),f.Sb(29,"div",18),f.Sb(30,"h4",19),f.Dc(31,"Add/Edit News"),f.Rb(),f.Sb(32,"button",20),f.Zb("click",function(){return f.vc(i),f.sc(26).hide()}),f.Sb(33,"span",21),f.Dc(34,"\xd7"),f.Rb(),f.Rb(),f.Rb(),f.Sb(35,"div",22),f.Sb(36,"form",23),f.Zb("ngSubmit",function(){return e.cropPriceSubmit()}),f.Sb(37,"div",24),f.Sb(38,"label",25),f.Dc(39,"Title"),f.Rb(),f.Nb(40,"input",26),f.Rb(),f.Sb(41,"div",24),f.Sb(42,"label",27),f.Dc(43,"Body"),f.Rb(),f.Nb(44,"textarea",28),f.Rb(),f.Sb(45,"div",24),f.Sb(46,"label",29),f.Dc(47,"Image"),f.Rb(),f.Sb(48,"div"),f.Bc(49,S,1,1,"img",30),f.Rb(),f.Sb(50,"input",31),f.Zb("change",function(t){return e.onChange(t)}),f.Rb(),f.Rb(),f.Sb(51,"button",32),f.Zb("click",function(){return f.vc(i),f.sc(26).hide()}),f.Dc(52," Close "),f.Rb(),f.Sb(53,"button",33),f.Bc(54,R,1,0,"span",34),f.Dc(55," Save changes "),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Sb(56,"div",14,35),f.Sb(58,"div",36),f.Sb(59,"div",17),f.Sb(60,"div",37),f.Dc(61," Do you want to delete this record? "),f.Rb(),f.Sb(62,"div",38),f.Sb(63,"button",32),f.Zb("click",function(){return f.vc(i),f.sc(57).hide()}),f.Dc(64," No! Cancel. "),f.Rb(),f.Sb(65,"button",39),f.Zb("click",function(){return e.deleteRecord()}),f.Dc(66," Yes! Delete. "),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb()}2&t&&(f.Ab(6),f.jc("disabled",e.disableButton),f.Ab(2),f.jc("disabled",e.disableButton),f.Ab(2),f.jc("disabled",!e.disableButton),f.Ab(5),f.jc("columnDefs",e.columnDefs)("rowData",e.rowData)("rowSelection",e.rowSelection),f.Ab(3),f.Hc("",e.from," to ",e.to," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.total,""),f.Ab(1),f.jc("disabled",e.disableNextButton),f.Ab(3),f.Gc("Page ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.page," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.pageCount,""),f.Ab(1),f.jc("disabled",e.disablePrevButton),f.Ab(13),f.jc("formGroup",e.newsForm),f.Ab(13),f.jc("ngIf",e.imageUrl),f.Ab(4),f.jc("disabled",e.btnLoading||!e.newsForm.valid),f.Ab(1),f.jc("ngIf",e.btnLoading))},directives:[c.a,u.a,r.t,r.j,r.e,r.b,r.i,r.d,s.k],encapsulation:2}),A),data:{roles:"KP_CALLER",title:"Indorama Updates"}}]}],I=((k=a(function t(){i(this,t)})).\u0275fac=function(t){return new(t||k)},k.\u0275mod=f.Kb({type:k}),k.\u0275inj=f.Jb({imports:[[b.g.forChild(D)],b.g]}),k),B=((U=a(function t(){i(this,t)})).\u0275fac=function(t){return new(t||U)},U.\u0275mod=f.Kb({type:U}),U.\u0275inj=f.Jb({imports:[[s.c,l.a,r.o,c.b.withComponents([]),I,d.c.forRoot(),u.b.forRoot(),r.f]]}),U)}}])}();