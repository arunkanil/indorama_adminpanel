!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{eFNz:function(e,a,n){"use strict";n.r(a),n.d(a,"IndoramaUpdatesModule",function(){return B});var s=n("SVse"),d=n("s7LF"),r=n("FE24"),l=n("2ZVE"),c=n("YFAK"),u=n("LqlI"),b=n("iInd"),h=n("R7Hv"),p=n("7nfi"),g=n("AytR"),m=n("8Y7J"),f=n("EApP"),v=["cropPriceModal"],y=["detailsModal"],w=["deleteModal"];function S(t,e){if(1&t&&m.Nb(0,"img",41),2&t){var i=m.cc();m.kc("src",i.imageUrl,m.xc)}}function R(t,e){1&t&&m.Nb(0,"span",42)}var A,k,U,D=[{path:"",children:[{path:"",redirectTo:"cropprices"},{path:"all",component:(A=function(){function e(o,a,n,s){i(this,e),this.dataservice=o,this.router=a,this.fb=n,this.toastr=s,this.baseURL=g.a.apiUrl,this.loading=!0,this.btnLoading=!1,this.disableButton=!0,this.disableNextButton=!1,this.disablePrevButton=!0,this.pageSize=20,this.from=1,this.to=20,this.count=1,this.orders={},this.columnDefs=[],this.newsForm=this.fb.group({Title:["",d.s.required],Body:["",d.s.required],Image:[""]}),this.rowData=[],this.selectedRows=[],this.selectedYear=(new Date).getFullYear(),this.years=[],this.filter={},this.file=null,this.columnDefs=t(p.g),this.rowSelection="single"}var a,n,s;return a=e,(n=[{key:"ngOnInit",value:function(){this.loading=!0,console.log(this.router),this.getUpdates(void 0,1,this.pageSize)}},{key:"getUpdates",value:function(t,e,i){var o=this;this.dataservice.getIndoramaUpdates(t,e,i).valueChanges.subscribe(function(t){var e,i,a,n,s,d;o.rowData=t.data.newsAndUpdates.data,o.meta=t.data.newsAndUpdates.meta,(null===(i=null===(e=o.meta)||void 0===e?void 0:e.pagination)||void 0===i?void 0:i.pageCount)<=1&&(o.disablePrevButton=!0,o.disableNextButton=!0),(null===(n=null===(a=o.meta)||void 0===a?void 0:a.pagination)||void 0===n?void 0:n.total)<o.pageSize&&(o.to=null===(d=null===(s=o.meta)||void 0===s?void 0:s.pagination)||void 0===d?void 0:d.total)})}},{key:"downloadExcel",value:function(){var t=this;this.btnLoading=!0,this.dataservice.downloadIndoramaUpdates().subscribe(function(e){var i;e.body,console.log(e),200===e.status&&"Success"==e.body.status?(t.toastr.success(e.body.message),t.btnLoading=!1,window.open("".concat(g.a.apiUrl).concat(null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.path),"_blank")):(t.btnLoading=!1,t.toastr.error(e.body.message))})}},{key:"loadNext",value:function(){var t,e,i,o,a=this;this.count++,this.disablePrevButton=!1,this.from=this.from+this.pageSize,this.to=this.to+this.pageSize>(null===(e=null===(t=this.meta)||void 0===t?void 0:t.pagination)||void 0===e?void 0:e.total)?null===(o=null===(i=this.meta)||void 0===i?void 0:i.pagination)||void 0===o?void 0:o.total:this.to+this.pageSize,this.count===this.meta.pagination.pageCount&&(this.disableNextButton=!0),this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(t){a.meta=t.data.newsAndUpdates.meta,a.rowData=t.data.newsAndUpdates.data})}},{key:"loadPrev",value:function(){var t=this;this.count--,this.count<this.meta.pagination.pageCount&&(this.disableNextButton=!1),1===this.count&&(this.disablePrevButton=!0),this.from=this.from-this.pageSize,this.to=this.to-this.rowData.length,this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(e){t.meta=e.data.newsAndUpdates.meta,t.rowData=e.data.newsAndUpdates.data})}},{key:"onGridReady",value:function(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.gridApi.sizeColumnsToFit()}},{key:"onRowClicked",value:function(t){console.log("row",t.data)}},{key:"onSelectionChanged",value:function(t){this.selectedRows=this.gridApi.getSelectedRows(),this.disableButton=!(this.selectedRows.length>0)}},{key:"onChange",value:function(t){this.file=[];for(var e=0;e<t.target.files.length;e++)this.file.push(t.target.files[e])}},{key:"openModal",value:function(t){var e,i,o,a,n,s,r,l;this.imageUrl=null,this.cropPriceModal.show(),t?(this.newsForm=this.fb.group({Title:[this.selectedRows[0].attributes.Title,d.s.required],Body:[this.selectedRows[0].attributes.Body,d.s.required],Image:[null===(i=null===(e=this.selectedRows[0].attributes.Images)||void 0===e?void 0:e.data[0])||void 0===i?void 0:i.id,d.s.required]}),this.imageUrl=(null===(n=null===(a=null===(o=this.selectedRows[0].attributes.Images)||void 0===o?void 0:o.data[0])||void 0===a?void 0:a.attributes)||void 0===n?void 0:n.url)?"".concat(this.baseURL)+(null===(l=null===(r=null===(s=this.selectedRows[0].attributes.Images)||void 0===s?void 0:s.data[0])||void 0===r?void 0:r.attributes)||void 0===l?void 0:l.url):null):(this.newsForm=this.fb.group({Title:["",d.s.required],Body:["",d.s.required],Image:["",d.s.required]}),this.imageUrl=null)}},{key:"deleteRecord",value:function(){var t=this;this.dataservice.UpdateIndoramaUpdates({isDelete:!0},this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.getUpdates(),t.file=null,t.deleteModal.hide(),t.gridApi.deselectAll()):t.toastr.error("Failed. Please check the fields!")})}},{key:"cropPriceSubmit",value:function(){var t=this;this.btnLoading=!0,console.log(this.newsForm.value),this.disableButton?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status?(console.log(e),t.dataservice.AddIndoramaUpdates(t.newsForm.value,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.createNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.cropPriceModal.hide(),t.newsForm.reset(),t.btnLoading=!1,t.getUpdates(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})):(t.toastr.error("Image failed to upload!"),t.btnLoading=!1)}):this.file?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status&&(console.log(e),t.dataservice.UpdateIndoramaUpdates(t.newsForm.value,t.selectedRows[0].id,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.getUpdates(),t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)}))}):this.dataservice.UpdateIndoramaUpdates(this.newsForm.value,this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll(),t.getUpdates()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})}}])&&o(a.prototype,n),s&&o(a,s),e}(),A.\u0275fac=function(t){return new(t||A)(m.Mb(h.a),m.Mb(b.c),m.Mb(d.c),m.Mb(f.b))},A.\u0275cmp=m.Gb({type:A,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Ic(v,1),m.Ic(y,1),m.Ic(w,1)),2&t&&(m.rc(i=m.ac())&&(e.cropPriceModal=i.first),m.rc(i=m.ac())&&(e.detailsModal=i.first),m.rc(i=m.ac())&&(e.deleteModal=i.first))},decls:69,vars:17,consts:[[1,"animated","fadeIn"],[1,"card"],[1,"card-header",2,"display","flex","justify-content","space-between"],["type","button","data-toggle","modal",1,"btn","btn-outline-primary",3,"click"],["type","button","data-toggle","modal",1,"btn","btn-danger",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-info",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-primary",3,"disabled","click"],[1,"card-body"],[1,"row"],[1,"col-12"],["id","myGrid","animateRows","true",1,"ag-theme-alpine",2,"width","100%","height","65vh",3,"columnDefs","rowData","rowSelection","selectionChanged","gridReady"],["agGrid",""],[1,"float-left","mt-3"],["type","button",1,"btn","btn-primary","float-right","m-2",3,"disabled","click"],[1,"float-right","mt-3"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],["cropPriceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","Title"],["type","text","id","Title","name","Title","formControlName","Title","placeholder","Enter title",1,"form-control"],["for","Body"],["id","Body","rows","5","name","Body","formControlName","Body","placeholder","Enter Body",1,"form-control"],["for","Image"],["width","100","height","100","style","object-fit: cover",3,"src",4,"ngIf"],["type","file","id","Image","accept",".jpg,.jpeg,.JPEG,.png","name","Image","formControlName","Image","placeholder","Choose image",1,"form-control",3,"change"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["deleteModal","bs-modal"],[1,"modal-dialog","modal-dialog-centered","modal-sm"],[1,"modal-body","text-center"],[1,"modal-footer","justify-content-around"],["type","button",1,"btn","btn-primary",3,"click"],["width","100","height","100",2,"object-fit","cover",3,"src"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(t,e){if(1&t){var i=m.Tb();m.Sb(0,"div",0),m.Sb(1,"div",1),m.Sb(2,"div",2),m.Sb(3,"h2"),m.Dc(4,"Indorama Updates"),m.Rb(),m.Sb(5,"div"),m.Sb(6,"button",3),m.Zb("click",function(){return e.downloadExcel()}),m.Dc(7," Download excel "),m.Rb(),m.Sb(8,"button",4),m.Zb("click",function(){return m.vc(i),m.sc(59).show()}),m.Dc(9," Delete "),m.Rb(),m.Sb(10,"button",5),m.Zb("click",function(){return e.openModal("Edit")}),m.Dc(11," Edit "),m.Rb(),m.Sb(12,"button",6),m.Zb("click",function(){return e.openModal()}),m.Dc(13," Add New Update "),m.Rb(),m.Rb(),m.Rb(),m.Sb(14,"div",7),m.Sb(15,"div",8),m.Sb(16,"div",9),m.Sb(17,"ag-grid-angular",10,11),m.Zb("selectionChanged",function(t){return e.onSelectionChanged(t)})("gridReady",function(t){return e.onGridReady(t)}),m.Rb(),m.Sb(19,"span",12),m.Dc(20),m.Rb(),m.Sb(21,"button",13),m.Zb("click",function(){return e.loadNext()}),m.Dc(22," Next "),m.Rb(),m.Sb(23,"span",14),m.Dc(24),m.Rb(),m.Sb(25,"button",13),m.Zb("click",function(){return e.loadPrev()}),m.Dc(26," Prev "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(27,"div",15,16),m.Sb(29,"div",17),m.Sb(30,"div",18),m.Sb(31,"div",19),m.Sb(32,"h4",20),m.Dc(33,"Add/Edit News"),m.Rb(),m.Sb(34,"button",21),m.Zb("click",function(){return m.vc(i),m.sc(28).hide()}),m.Sb(35,"span",22),m.Dc(36,"\xd7"),m.Rb(),m.Rb(),m.Rb(),m.Sb(37,"div",23),m.Sb(38,"form",24),m.Zb("ngSubmit",function(){return e.cropPriceSubmit()}),m.Sb(39,"div",25),m.Sb(40,"label",26),m.Dc(41,"Title"),m.Rb(),m.Nb(42,"input",27),m.Rb(),m.Sb(43,"div",25),m.Sb(44,"label",28),m.Dc(45,"Body"),m.Rb(),m.Nb(46,"textarea",29),m.Rb(),m.Sb(47,"div",25),m.Sb(48,"label",30),m.Dc(49,"Image"),m.Rb(),m.Sb(50,"div"),m.Bc(51,S,1,1,"img",31),m.Rb(),m.Sb(52,"input",32),m.Zb("change",function(t){return e.onChange(t)}),m.Rb(),m.Rb(),m.Sb(53,"button",33),m.Zb("click",function(){return m.vc(i),m.sc(28).hide()}),m.Dc(54," Close "),m.Rb(),m.Sb(55,"button",34),m.Bc(56,R,1,0,"span",35),m.Dc(57," Save changes "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(58,"div",15,36),m.Sb(60,"div",37),m.Sb(61,"div",18),m.Sb(62,"div",38),m.Dc(63," Do you want to delete this record? "),m.Rb(),m.Sb(64,"div",39),m.Sb(65,"button",33),m.Zb("click",function(){return m.vc(i),m.sc(59).hide()}),m.Dc(66," No! Cancel. "),m.Rb(),m.Sb(67,"button",40),m.Zb("click",function(){return e.deleteRecord()}),m.Dc(68," Yes! Delete. "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb()}2&t&&(m.Ab(8),m.jc("disabled",e.disableButton),m.Ab(2),m.jc("disabled",e.disableButton),m.Ab(2),m.jc("disabled",!e.disableButton),m.Ab(5),m.jc("columnDefs",e.columnDefs)("rowData",e.rowData)("rowSelection",e.rowSelection),m.Ab(3),m.Hc("",e.from," to ",e.to," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.total,""),m.Ab(1),m.jc("disabled",e.disableNextButton),m.Ab(3),m.Gc("Page ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.page," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.pageCount,""),m.Ab(1),m.jc("disabled",e.disablePrevButton),m.Ab(13),m.jc("formGroup",e.newsForm),m.Ab(13),m.jc("ngIf",e.imageUrl),m.Ab(4),m.jc("disabled",e.btnLoading||!e.newsForm.valid),m.Ab(1),m.jc("ngIf",e.btnLoading))},directives:[c.a,u.a,d.t,d.j,d.e,d.b,d.i,d.d,s.k],encapsulation:2}),A),data:{roles:"KP_CALLER",title:"Indorama Updates"}}]}],I=((U=function t(){i(this,t)}).\u0275fac=function(t){return new(t||U)},U.\u0275mod=m.Kb({type:U}),U.\u0275inj=m.Jb({imports:[[b.g.forChild(D)],b.g]}),U),B=((k=function t(){i(this,t)}).\u0275fac=function(t){return new(t||k)},k.\u0275mod=m.Kb({type:k}),k.\u0275inj=m.Jb({imports:[[s.c,l.a,d.o,c.b.withComponents([]),I,r.c.forRoot(),u.b.forRoot(),d.f]]}),k)}}])}();