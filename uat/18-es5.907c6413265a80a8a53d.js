!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{eFNz:function(e,o,n){"use strict";n.r(o),n.d(o,"IndoramaUpdatesModule",function(){return B});var s=n("SVse"),d=n("s7LF"),r=n("FE24"),l=n("2ZVE"),c=n("YFAK"),u=n("LqlI"),b=n("iInd"),h=n("R7Hv"),p=n("7nfi"),g=n("AytR"),m=n("8Y7J"),f=n("EApP"),v=["cropPriceModal"],w=["detailsModal"],y=["deleteModal"];function S(t,e){if(1&t&&m.Nb(0,"img",40),2&t){var i=m.cc();m.kc("src",i.imageUrl,m.xc)}}function R(t,e){1&t&&m.Nb(0,"span",41)}var A,U,k,D=[{path:"",children:[{path:"",redirectTo:"cropprices"},{path:"all",component:(A=function(){function e(a,o,n,s){i(this,e),this.dataservice=a,this.router=o,this.fb=n,this.toastr=s,this.baseURL=g.a.apiUrl,this.loading=!0,this.btnLoading=!1,this.disableButton=!0,this.disableNextButton=!1,this.disablePrevButton=!0,this.pageSize=20,this.from=1,this.to=20,this.count=1,this.orders={},this.columnDefs=[],this.newsForm=this.fb.group({Title:["",d.s.required],Body:["",d.s.required],Image:[""]}),this.rowData=[],this.selectedRows=[],this.selectedYear=(new Date).getFullYear(),this.years=[],this.filter={},this.file=null,this.columnDefs=t(p.g),this.rowSelection="single"}var o,n,s;return o=e,(n=[{key:"ngOnInit",value:function(){this.loading=!0,console.log(this.router),this.getUpdates(void 0,1,this.pageSize)}},{key:"getUpdates",value:function(t,e,i){var a=this;this.dataservice.getIndoramaUpdates(t,e,i).valueChanges.subscribe(function(t){var e,i,o,n,s,d;a.rowData=t.data.newsAndUpdates.data,a.meta=t.data.newsAndUpdates.meta,(null===(i=null===(e=a.meta)||void 0===e?void 0:e.pagination)||void 0===i?void 0:i.pageCount)<=1&&(a.disablePrevButton=!0,a.disableNextButton=!0),(null===(n=null===(o=a.meta)||void 0===o?void 0:o.pagination)||void 0===n?void 0:n.total)<a.pageSize&&(a.to=null===(d=null===(s=a.meta)||void 0===s?void 0:s.pagination)||void 0===d?void 0:d.total)})}},{key:"loadNext",value:function(){var t,e,i,a,o=this;this.count++,this.disablePrevButton=!1,this.from=this.from+this.pageSize,this.to=this.to+this.pageSize>(null===(e=null===(t=this.meta)||void 0===t?void 0:t.pagination)||void 0===e?void 0:e.total)?null===(a=null===(i=this.meta)||void 0===i?void 0:i.pagination)||void 0===a?void 0:a.total:this.to+this.pageSize,this.count===this.meta.pagination.pageCount&&(this.disableNextButton=!0),this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(t){o.meta=t.data.newsAndUpdates.meta,o.rowData=t.data.newsAndUpdates.data})}},{key:"loadPrev",value:function(){var t=this;this.count--,this.count<this.meta.pagination.pageCount&&(this.disableNextButton=!1),1===this.count&&(this.disablePrevButton=!0),this.from=this.from-this.pageSize,this.to=this.to-this.rowData.length,this.dataservice.getIndoramaUpdates(void 0,this.count,this.pageSize).valueChanges.subscribe(function(e){t.meta=e.data.newsAndUpdates.meta,t.rowData=e.data.newsAndUpdates.data})}},{key:"onGridReady",value:function(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.gridApi.sizeColumnsToFit()}},{key:"onRowClicked",value:function(t){console.log("row",t.data)}},{key:"onSelectionChanged",value:function(t){this.selectedRows=this.gridApi.getSelectedRows(),this.disableButton=!(this.selectedRows.length>0)}},{key:"onChange",value:function(t){this.file=[];for(var e=0;e<t.target.files.length;e++)this.file.push(t.target.files[e])}},{key:"openModal",value:function(t){var e,i,a,o,n,s,r,l;this.imageUrl=null,this.cropPriceModal.show(),t?(this.newsForm=this.fb.group({Title:[this.selectedRows[0].attributes.Title,d.s.required],Body:[this.selectedRows[0].attributes.Body,d.s.required],Image:[null===(i=null===(e=this.selectedRows[0].attributes.Images)||void 0===e?void 0:e.data[0])||void 0===i?void 0:i.id,d.s.required]}),this.imageUrl=(null===(n=null===(o=null===(a=this.selectedRows[0].attributes.Images)||void 0===a?void 0:a.data[0])||void 0===o?void 0:o.attributes)||void 0===n?void 0:n.url)?"".concat(this.baseURL)+(null===(l=null===(r=null===(s=this.selectedRows[0].attributes.Images)||void 0===s?void 0:s.data[0])||void 0===r?void 0:r.attributes)||void 0===l?void 0:l.url):null):(this.newsForm=this.fb.group({Title:["",d.s.required],Body:["",d.s.required],Image:["",d.s.required]}),this.imageUrl=null)}},{key:"deleteRecord",value:function(){var t=this;this.dataservice.UpdateIndoramaUpdates({isDelete:!0},this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.getUpdates(),t.file=null,t.deleteModal.hide(),t.gridApi.deselectAll()):t.toastr.error("Failed. Please check the fields!")})}},{key:"cropPriceSubmit",value:function(){var t=this;this.btnLoading=!0,console.log(this.newsForm.value),this.disableButton?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status?(console.log(e),t.dataservice.AddIndoramaUpdates(t.newsForm.value,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.createNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.cropPriceModal.hide(),t.newsForm.reset(),t.btnLoading=!1,t.getUpdates(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})):(t.toastr.error("Image failed to upload!"),t.btnLoading=!1)}):this.file?this.dataservice.upload(this.file).subscribe(function(e){var i;200==e.status&&(console.log(e),t.dataservice.UpdateIndoramaUpdates(t.newsForm.value,t.selectedRows[0].id,null===(i=e.body[0])||void 0===i?void 0:i.id).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.getUpdates(),t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)}))}):this.dataservice.UpdateIndoramaUpdates(this.newsForm.value,this.selectedRows[0].id,null).subscribe(function(e){e.data,console.log("response",e),e.data.updateNewsAndUpdate?(t.toastr.success("Success!"),t.file=null,t.btnLoading=!1,t.cropPriceModal.hide(),t.newsForm.reset(),t.gridApi.deselectAll(),t.getUpdates()):(t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1)})}}])&&a(o.prototype,n),s&&a(o,s),e}(),A.\u0275fac=function(t){return new(t||A)(m.Mb(h.a),m.Mb(b.c),m.Mb(d.c),m.Mb(f.b))},A.\u0275cmp=m.Gb({type:A,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&(m.Ic(v,1),m.Ic(w,1),m.Ic(y,1)),2&t&&(m.rc(i=m.ac())&&(e.cropPriceModal=i.first),m.rc(i=m.ac())&&(e.detailsModal=i.first),m.rc(i=m.ac())&&(e.deleteModal=i.first))},decls:67,vars:17,consts:[[1,"animated","fadeIn"],[1,"card"],[1,"card-header",2,"display","flex","justify-content","space-between"],["type","button","data-toggle","modal",1,"btn","btn-danger",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-info",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-primary",3,"disabled","click"],[1,"card-body"],[1,"row"],[1,"col-12"],["id","myGrid","animateRows","true",1,"ag-theme-alpine",2,"width","100%","height","65vh",3,"columnDefs","rowData","rowSelection","selectionChanged","gridReady"],["agGrid",""],[1,"float-left","mt-3"],["type","button",1,"btn","btn-primary","float-right","m-2",3,"disabled","click"],[1,"float-right","mt-3"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],["cropPriceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","Title"],["type","text","id","Title","name","Title","formControlName","Title","placeholder","Enter title",1,"form-control"],["for","Body"],["id","Body","rows","5","name","Body","formControlName","Body","placeholder","Enter Body",1,"form-control"],["for","Image"],["width","100","height","100","style","object-fit: cover",3,"src",4,"ngIf"],["type","file","id","Image","accept",".jpg,.jpeg,.JPEG,.png","name","Image","formControlName","Image","placeholder","Choose image",1,"form-control",3,"change"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["deleteModal","bs-modal"],[1,"modal-dialog","modal-dialog-centered","modal-sm"],[1,"modal-body","text-center"],[1,"modal-footer","justify-content-around"],["type","button",1,"btn","btn-primary",3,"click"],["width","100","height","100",2,"object-fit","cover",3,"src"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(t,e){if(1&t){var i=m.Tb();m.Sb(0,"div",0),m.Sb(1,"div",1),m.Sb(2,"div",2),m.Sb(3,"h2"),m.Dc(4,"Indorama Updates"),m.Rb(),m.Sb(5,"div"),m.Sb(6,"button",3),m.Zb("click",function(){return m.vc(i),m.sc(57).show()}),m.Dc(7," Delete "),m.Rb(),m.Sb(8,"button",4),m.Zb("click",function(){return e.openModal("Edit")}),m.Dc(9," Edit "),m.Rb(),m.Sb(10,"button",5),m.Zb("click",function(){return e.openModal()}),m.Dc(11," Add New Update "),m.Rb(),m.Rb(),m.Rb(),m.Sb(12,"div",6),m.Sb(13,"div",7),m.Sb(14,"div",8),m.Sb(15,"ag-grid-angular",9,10),m.Zb("selectionChanged",function(t){return e.onSelectionChanged(t)})("gridReady",function(t){return e.onGridReady(t)}),m.Rb(),m.Sb(17,"span",11),m.Dc(18),m.Rb(),m.Sb(19,"button",12),m.Zb("click",function(){return e.loadNext()}),m.Dc(20," Next "),m.Rb(),m.Sb(21,"span",13),m.Dc(22),m.Rb(),m.Sb(23,"button",12),m.Zb("click",function(){return e.loadPrev()}),m.Dc(24," Prev "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(25,"div",14,15),m.Sb(27,"div",16),m.Sb(28,"div",17),m.Sb(29,"div",18),m.Sb(30,"h4",19),m.Dc(31,"Add/Edit News"),m.Rb(),m.Sb(32,"button",20),m.Zb("click",function(){return m.vc(i),m.sc(26).hide()}),m.Sb(33,"span",21),m.Dc(34,"\xd7"),m.Rb(),m.Rb(),m.Rb(),m.Sb(35,"div",22),m.Sb(36,"form",23),m.Zb("ngSubmit",function(){return e.cropPriceSubmit()}),m.Sb(37,"div",24),m.Sb(38,"label",25),m.Dc(39,"Title"),m.Rb(),m.Nb(40,"input",26),m.Rb(),m.Sb(41,"div",24),m.Sb(42,"label",27),m.Dc(43,"Body"),m.Rb(),m.Nb(44,"textarea",28),m.Rb(),m.Sb(45,"div",24),m.Sb(46,"label",29),m.Dc(47,"Image"),m.Rb(),m.Sb(48,"div"),m.Bc(49,S,1,1,"img",30),m.Rb(),m.Sb(50,"input",31),m.Zb("change",function(t){return e.onChange(t)}),m.Rb(),m.Rb(),m.Sb(51,"button",32),m.Zb("click",function(){return m.vc(i),m.sc(26).hide()}),m.Dc(52," Close "),m.Rb(),m.Sb(53,"button",33),m.Bc(54,R,1,0,"span",34),m.Dc(55," Save changes "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(56,"div",14,35),m.Sb(58,"div",36),m.Sb(59,"div",17),m.Sb(60,"div",37),m.Dc(61," Do you want to delete this record? "),m.Rb(),m.Sb(62,"div",38),m.Sb(63,"button",32),m.Zb("click",function(){return m.vc(i),m.sc(57).hide()}),m.Dc(64," No! Cancel. "),m.Rb(),m.Sb(65,"button",39),m.Zb("click",function(){return e.deleteRecord()}),m.Dc(66," Yes! Delete. "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb()}2&t&&(m.Ab(6),m.jc("disabled",e.disableButton),m.Ab(2),m.jc("disabled",e.disableButton),m.Ab(2),m.jc("disabled",!e.disableButton),m.Ab(5),m.jc("columnDefs",e.columnDefs)("rowData",e.rowData)("rowSelection",e.rowSelection),m.Ab(3),m.Hc("",e.from," to ",e.to," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.total,""),m.Ab(1),m.jc("disabled",e.disableNextButton),m.Ab(3),m.Gc("Page ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.page," of ",null==e.meta||null==e.meta.pagination?null:e.meta.pagination.pageCount,""),m.Ab(1),m.jc("disabled",e.disablePrevButton),m.Ab(13),m.jc("formGroup",e.newsForm),m.Ab(13),m.jc("ngIf",e.imageUrl),m.Ab(4),m.jc("disabled",e.btnLoading||!e.newsForm.valid),m.Ab(1),m.jc("ngIf",e.btnLoading))},directives:[c.a,u.a,d.t,d.j,d.e,d.b,d.i,d.d,s.k],encapsulation:2}),A),data:{roles:"KP_CALLER",title:"Indorama Updates"}}]}],I=((k=function t(){i(this,t)}).\u0275fac=function(t){return new(t||k)},k.\u0275mod=m.Kb({type:k}),k.\u0275inj=m.Jb({imports:[[b.g.forChild(D)],b.g]}),k),B=((U=function t(){i(this,t)}).\u0275fac=function(t){return new(t||U)},U.\u0275mod=m.Kb({type:U}),U.\u0275inj=m.Jb({imports:[[s.c,l.a,d.o,c.b.withComponents([]),I,r.c.forRoot(),u.b.forRoot(),d.f]]}),U)}}])}();