!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"N8R/":function(t,r,a){"use strict";a.r(r),a.d(r,"CropPricesModule",function(){return I});var n=a("SVse"),s=a("s7LF"),c=a("FE24"),l=a("2ZVE"),d=a("iInd"),u=a("R7Hv"),b=a("7nfi"),p=a("AytR"),h=a("8Y7J"),g=a("EApP"),v=a("YFAK"),f=a("LqlI"),m=["cropPriceModal"],S=["approveModal"];function R(e,t){if(1&e){var i=h.Tb();h.Sb(0,"ul",51),h.Sb(1,"li",52),h.Sb(2,"a",53),h.Zb("click",function(){return h.vc(i),h.cc().toggleCropPrices("All")}),h.Dc(3,"All"),h.Rb(),h.Sb(4,"a",53),h.Zb("click",function(){return h.vc(i),h.cc().toggleCropPrices("Approvalpending")}),h.Dc(5,"Approval pending"),h.Rb(),h.Sb(6,"a",53),h.Zb("click",function(){return h.vc(i),h.cc().toggleCropPrices("Rejected")}),h.Dc(7,"Rejected"),h.Rb(),h.Rb(),h.Rb()}}function P(e,t){if(1&e&&(h.Sb(0,"option",54),h.Dc(1),h.Rb()),2&e){var i=t.$implicit;h.kc("value",i.id),h.Ab(1),h.Fc(" ",i.attributes.Name," ")}}function y(e,t){if(1&e&&(h.Sb(0,"option",54),h.Dc(1),h.Rb()),2&e){var i=t.$implicit;h.kc("value",i.id),h.Ab(1),h.Fc(" ",i.attributes.Name," ")}}function k(e,t){if(1&e&&(h.Sb(0,"option",54),h.Dc(1),h.Rb()),2&e){var i=t.$implicit;h.kc("value",i.id),h.Ab(1),h.Fc(" ",i.attributes.Name," ")}}function C(e,t){if(1&e&&h.Nb(0,"img",55),2&e){var i=h.cc();h.kc("src",i.imageUrl,h.xc)}}function w(e,t){1&e&&h.Nb(0,"span",56)}var A,D,j,M=[{path:"",children:[{path:"",redirectTo:"cropprices"},{path:"all",component:(A=function(){function t(o,r,a,n){i(this,t),this.dataservice=o,this.router=r,this.fb=a,this.toastr=n,this.loading=!0,this.btnLoading=!1,this.disableButton=!0,this.disableNextButton=!1,this.disablePrevButton=!0,this.selectedList="All",this.listCheck=!1,this.publicationState="PREVIEW",this.toApprove=void 0,this.isRejected=void 0,this.columnDefs=[],this.States=[],this.Markets=[],this.Crops=[],this.pageSize=20,this.from=1,this.to=20,this.count=1,this.cropPriceForm=this.fb.group({crop:["",s.s.required],state:["",s.s.required],market:["",s.s.required],Price:["",s.s.required],Unit:["",s.s.required],Image:[""]}),this.rowData=[],this.selectedRows=[],this.selectedYear=(new Date).getFullYear(),this.years=[],this.filter={},this.file=null,this.columnDefs=e(b.d),this.rowSelection="single"}var r,a,n;return r=t,(a=[{key:"ngOnInit",value:function(){this.loading=!0,console.log(this.router),this.getCropPrices(),this.getCrops(),this.getMarkets(),this.getStates()}},{key:"getCropPrices",value:function(){var e=this;this.dataservice.getCropPrices(1,this.pageSize,this.publicationState,this.toApprove,this.isRejected).valueChanges.subscribe(function(t){var i,o,r,a,n,s;e.rowData=t.data.cropPrices.data,e.meta=t.data.cropPrices.meta,(null===(o=null===(i=e.meta)||void 0===i?void 0:i.pagination)||void 0===o?void 0:o.pageCount)<=1&&(e.disablePrevButton=!0,e.disableNextButton=!0),(null===(a=null===(r=e.meta)||void 0===r?void 0:r.pagination)||void 0===a?void 0:a.total)<e.pageSize&&(e.to=null===(s=null===(n=e.meta)||void 0===n?void 0:n.pagination)||void 0===s?void 0:s.total)})}},{key:"getCrops",value:function(){var e=this;this.dataservice.getCrops().valueChanges.subscribe(function(t){e.Crops=t.data.crops.data})}},{key:"loadNext",value:function(){var e,t,i,o,r=this;this.count++,this.disablePrevButton=!1,this.from=this.from+this.pageSize,this.to=this.to+this.pageSize>(null===(t=null===(e=this.meta)||void 0===e?void 0:e.pagination)||void 0===t?void 0:t.total)?null===(o=null===(i=this.meta)||void 0===i?void 0:i.pagination)||void 0===o?void 0:o.total:this.to+this.pageSize,this.count===this.meta.pagination.pageCount&&(this.disableNextButton=!0),this.dataservice.getCropPrices(this.count,this.pageSize,this.publicationState,this.toApprove).valueChanges.subscribe(function(e){r.meta=e.data.cropPrices.meta,r.rowData=e.data.cropPrices.data})}},{key:"loadPrev",value:function(){var e=this;this.count--,this.count<this.meta.pagination.pageCount&&(this.disableNextButton=!1),1===this.count&&(this.disablePrevButton=!0),this.from=this.from-this.pageSize,this.to=this.to-this.rowData.length,this.dataservice.getCropPrices(this.count,this.pageSize,this.publicationState,this.toApprove).valueChanges.subscribe(function(t){e.meta=t.data.cropPrices.meta,e.rowData=t.data.cropPrices.data})}},{key:"getStates",value:function(){var e=this;this.dataservice.getStates().valueChanges.subscribe(function(t){console.log("getStates",t.data.states.data),e.States=t.data.states.data})}},{key:"getMarkets",value:function(e){var t=this;this.dataservice.getMarkets(e).valueChanges.subscribe(function(e){console.log("getMarkets",e.data.markets.data),t.Markets=e.data.markets.data})}},{key:"filterMarkets",value:function(e){this.getMarkets(e.target.value)}},{key:"toggleCropPrices",value:function(e){switch(e){case"Rejected":this.selectedList="Rejected",this.publicationState="PREVIEW",this.toApprove=null,this.isRejected=!0,this.getCropPrices();break;case"Approvalpending":this.selectedList="Pending",this.publicationState="PREVIEW",this.toApprove=null,this.isRejected=!1,this.getCropPrices();break;case"All":this.selectedList="All",this.publicationState="PREVIEW",this.toApprove=void 0,this.isRejected=void 0,this.getCropPrices()}}},{key:"onGridReady",value:function(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.gridApi.sizeColumnsToFit()}},{key:"onRowClicked",value:function(e){console.log("row",e.data)}},{key:"onSelectionChanged",value:function(e){this.selectedRows=this.gridApi.getSelectedRows(),this.disableButton=!(this.selectedRows.length>0)}},{key:"onChange",value:function(e){this.file=[];for(var t=0;t<e.target.files.length;t++)this.file.push(e.target.files[t]);console.log(this.file)}},{key:"approveOrReject",value:function(e){var t=this,i=null;e||(i=new Date),this.dataservice.UpdateCropPrice(void 0,this.selectedRows[0].id,void 0,e,i).subscribe(function(e){console.log("response",e),e.data.updateCropPrice&&(t.toastr.success("Success!"),t.getCropPrices(),t.file=null,t.approveModal.hide(),t.gridApi.deselectAll(),t.btnLoading=!1)},function(e){t.toastr.error("Failed. Please check the fields!"),t.btnLoading=!1})}},{key:"openApproveModal",value:function(){this.approveModal.show()}},{key:"openModal",value:function(e){var t,i,o,r,a,n,c,l;this.imageUrl=null,this.cropPriceModal.show(),e?(this.cropPriceForm=this.fb.group({crop:[this.selectedRows[0].attributes.crop.data.id,s.s.required],state:[this.selectedRows[0].attributes.state.data.id,s.s.required],market:[this.selectedRows[0].attributes.market.data.id,s.s.required],Price:[this.selectedRows[0].attributes.Price,s.s.required],Unit:[this.selectedRows[0].attributes.Unit,s.s.required],Image:[null===(i=null===(t=this.selectedRows[0].attributes.Image)||void 0===t?void 0:t.data)||void 0===i?void 0:i.id,s.s.required]}),this.imageUrl=(null===(a=null===(r=null===(o=this.selectedRows[0].attributes.Image)||void 0===o?void 0:o.data)||void 0===r?void 0:r.attributes)||void 0===a?void 0:a.url)?"".concat(p.a.apiUrl)+(null===(l=null===(c=null===(n=this.selectedRows[0].attributes.Image)||void 0===n?void 0:n.data)||void 0===c?void 0:c.attributes)||void 0===l?void 0:l.url):null):(this.cropPriceForm=this.fb.group({crop:["",s.s.required],state:["",s.s.required],market:["",s.s.required],Price:["",s.s.required],Unit:["",s.s.required],Image:["",s.s.required]}),this.imageUrl=null)}},{key:"cropPriceSubmit",value:function(){var e=this;this.btnLoading=!0,console.log(this.cropPriceForm.value),this.disableButton?this.dataservice.upload(this.file).subscribe(function(t){var i;200==t.status?(console.log(t),e.dataservice.AddCropPrice(e.cropPriceForm.value,null===(i=t.body[0])||void 0===i?void 0:i.id).subscribe(function(t){t.data,console.log("response",t),t.data.createCropPrice&&(e.toastr.success("Success!"),e.getCropPrices(),e.file=null,e.cropPriceModal.hide(),e.cropPriceForm.reset(),e.gridApi.deselectAll()),e.btnLoading=!1},function(t){e.toastr.error("Failed. Please check the fields!"),e.btnLoading=!1})):e.toastr.error("Image failed to upload!")}):this.file?this.dataservice.upload(this.file).subscribe(function(t){var i;200==t.status&&(console.log(t),e.dataservice.UpdateCropPrice(e.cropPriceForm.value,e.selectedRows[0].id,null===(i=t.body[0])||void 0===i?void 0:i.id).subscribe(function(t){t.data,console.log("response",t),t.data.updateCropPrice&&(e.toastr.success("Success!"),e.getCropPrices(),e.file=null,e.cropPriceModal.hide(),e.cropPriceForm.reset(),e.gridApi.deselectAll(),e.btnLoading=!1)},function(t){e.toastr.error("Failed. Please check the fields!"),e.btnLoading=!1}))}):this.dataservice.UpdateCropPrice(this.cropPriceForm.value,this.selectedRows[0].id,null).subscribe(function(t){t.data,console.log("response",t),t.data.updateCropPrice&&(e.toastr.success("Success!"),e.getCropPrices(),e.file=null,e.cropPriceModal.hide(),e.cropPriceForm.reset(),e.gridApi.deselectAll(),e.btnLoading=!1)},function(t){e.toastr.error("Failed. Please check the fields!"),e.btnLoading=!1})}}])&&o(r.prototype,a),n&&o(r,n),t}(),A.\u0275fac=function(e){return new(e||A)(h.Mb(u.a),h.Mb(d.c),h.Mb(s.c),h.Mb(g.b))},A.\u0275cmp=h.Gb({type:A,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(h.Ic(m,1),h.Ic(S,1)),2&e&&(h.rc(i=h.ac())&&(t.cropPriceModal=i.first),h.rc(i=h.ac())&&(t.approveModal=i.first))},decls:95,vars:21,consts:[[1,"animated","fadeIn"],[1,"card"],[1,"card-header",2,"display","flex","justify-content","space-between"],["type","button","data-toggle","modal",1,"btn","btn-warning",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-info",3,"disabled","click"],["type","button","data-toggle","modal",1,"btn","btn-primary",3,"disabled","click"],[1,"card-body"],[1,"row"],[1,"col-12"],["dropdown","",1,"btn-group","float-right","mb-3"],["dropdownToggle","","type","button",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["class","dropdown-menu","role","menu",4,"dropdownMenu"],["id","myGrid","animateRows","true",1,"ag-theme-alpine",2,"width","100%","height","65vh",3,"columnDefs","rowData","rowSelection","selectionChanged","gridReady"],["agGrid",""],[1,"float-left","mt-3"],["type","button",1,"btn","btn-primary","float-right","m-2",3,"disabled","click"],[1,"float-right","mt-3"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],["cropPriceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","state"],["id","state","required","","ngModel","","name","state","formControlName","state",1,"form-control",3,"change"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],["for","market"],["id","market","required","","ngModel","","name","market","formControlName","market",1,"form-control"],["for","crop"],["id","crop","required","","ngModel","","name","crop","formControlName","crop",1,"form-control"],["for","name"],["type","text","id","Price","name","Price","formControlName","Price","placeholder","Enter price",1,"form-control"],["type","text","id","Unit","name","Unit","formControlName","Unit","placeholder","Enter unit",1,"form-control"],["for","Image"],["width","100","height","100","style","object-fit: cover",3,"src",4,"ngIf"],["type","file","id","Image","accept",".jpg,.jpeg,.JPEG,.png","name","Image","formControlName","Image","placeholder","Choose image",1,"form-control",3,"change"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["approveModal","bs-modal"],[1,"modal-dialog","modal-dialog-centered","modal-sm"],[1,"modal-body","text-center"],[1,"modal-footer","justify-content-around"],["type","button",1,"btn","btn-primary",3,"click"],["role","menu",1,"dropdown-menu"],["role","menuitem"],[1,"dropdown-item",3,"click"],[3,"value"],["width","100","height","100",2,"object-fit","cover",3,"src"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,t){if(1&e){var i=h.Tb();h.Sb(0,"div",0),h.Sb(1,"div",1),h.Sb(2,"div",2),h.Sb(3,"h2"),h.Dc(4,"Crop Prices Home"),h.Rb(),h.Sb(5,"div"),h.Sb(6,"button",3),h.Zb("click",function(){return t.openApproveModal()}),h.Dc(7," Approve / Reject "),h.Rb(),h.Sb(8,"button",4),h.Zb("click",function(){return t.openModal("Edit")}),h.Dc(9," Edit "),h.Rb(),h.Sb(10,"button",5),h.Zb("click",function(){return t.openModal()}),h.Dc(11," Add New Price "),h.Rb(),h.Rb(),h.Rb(),h.Sb(12,"div",6),h.Sb(13,"div",7),h.Sb(14,"div",8),h.Sb(15,"div",9),h.Sb(16,"button",10),h.Dc(17),h.Nb(18,"span",11),h.Rb(),h.Bc(19,R,8,0,"ul",12),h.Rb(),h.Rb(),h.Rb(),h.Sb(20,"div",7),h.Sb(21,"div",8),h.Sb(22,"ag-grid-angular",13,14),h.Zb("selectionChanged",function(e){return t.onSelectionChanged(e)})("gridReady",function(e){return t.onGridReady(e)}),h.Rb(),h.Sb(24,"span",15),h.Dc(25),h.Rb(),h.Sb(26,"button",16),h.Zb("click",function(){return t.loadNext()}),h.Dc(27," Next "),h.Rb(),h.Sb(28,"span",17),h.Dc(29),h.Rb(),h.Sb(30,"button",16),h.Zb("click",function(){return t.loadPrev()}),h.Dc(31," Prev "),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Sb(32,"div",18,19),h.Sb(34,"div",20),h.Sb(35,"div",21),h.Sb(36,"div",22),h.Sb(37,"h4",23),h.Dc(38,"Add/Edit Crop Price"),h.Rb(),h.Sb(39,"button",24),h.Zb("click",function(){return h.vc(i),h.sc(33).hide()}),h.Sb(40,"span",25),h.Dc(41,"\xd7"),h.Rb(),h.Rb(),h.Rb(),h.Sb(42,"div",26),h.Sb(43,"form",27),h.Zb("ngSubmit",function(){return t.cropPriceSubmit()}),h.Sb(44,"div",28),h.Sb(45,"label",29),h.Dc(46,"State"),h.Rb(),h.Sb(47,"select",30),h.Zb("change",function(e){return t.filterMarkets(e)}),h.Sb(48,"option",31),h.Dc(49,"Choose..."),h.Rb(),h.Bc(50,P,2,2,"option",32),h.Rb(),h.Rb(),h.Sb(51,"div",28),h.Sb(52,"label",33),h.Dc(53,"Market"),h.Rb(),h.Sb(54,"select",34),h.Sb(55,"option",31),h.Dc(56,"Choose..."),h.Rb(),h.Bc(57,y,2,2,"option",32),h.Rb(),h.Rb(),h.Sb(58,"div",28),h.Sb(59,"label",35),h.Dc(60,"Crop"),h.Rb(),h.Sb(61,"select",36),h.Sb(62,"option",31),h.Dc(63,"Choose..."),h.Rb(),h.Bc(64,k,2,2,"option",32),h.Rb(),h.Rb(),h.Sb(65,"div",28),h.Sb(66,"label",37),h.Dc(67,"Price (NGN)"),h.Rb(),h.Nb(68,"input",38),h.Rb(),h.Sb(69,"div",28),h.Sb(70,"label",37),h.Dc(71,"Unit"),h.Rb(),h.Nb(72,"input",39),h.Rb(),h.Sb(73,"div",28),h.Sb(74,"label",40),h.Dc(75,"Image"),h.Rb(),h.Sb(76,"div"),h.Bc(77,C,1,1,"img",41),h.Rb(),h.Sb(78,"input",42),h.Zb("change",function(e){return t.onChange(e)}),h.Rb(),h.Rb(),h.Sb(79,"button",43),h.Zb("click",function(){return h.vc(i),h.sc(33).hide()}),h.Dc(80," Close "),h.Rb(),h.Sb(81,"button",44),h.Bc(82,w,1,0,"span",45),h.Dc(83," Save changes "),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Sb(84,"div",18,46),h.Sb(86,"div",47),h.Sb(87,"div",21),h.Sb(88,"div",48),h.Dc(89," Do you want to approve this record? "),h.Rb(),h.Sb(90,"div",49),h.Sb(91,"button",43),h.Zb("click",function(){return t.approveOrReject(!0)}),h.Dc(92," No! Reject. "),h.Rb(),h.Sb(93,"button",50),h.Zb("click",function(){return t.approveOrReject(!1)}),h.Dc(94," Yes! Approve. "),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Rb()}2&e&&(h.Ab(6),h.jc("disabled",t.disableButton),h.Ab(2),h.jc("disabled",t.disableButton),h.Ab(2),h.jc("disabled",!t.disableButton),h.Ab(7),h.Fc(" ",t.selectedList,""),h.Ab(5),h.jc("columnDefs",t.columnDefs)("rowData",t.rowData)("rowSelection",t.rowSelection),h.Ab(3),h.Hc("",t.from," to ",t.to," of ",null==t.meta||null==t.meta.pagination?null:t.meta.pagination.total,""),h.Ab(1),h.jc("disabled",t.disableNextButton),h.Ab(3),h.Gc("Page ",null==t.meta||null==t.meta.pagination?null:t.meta.pagination.page," of ",null==t.meta||null==t.meta.pagination?null:t.meta.pagination.pageCount,""),h.Ab(1),h.jc("disabled",t.disablePrevButton),h.Ab(13),h.jc("formGroup",t.cropPriceForm),h.Ab(7),h.jc("ngForOf",t.States),h.Ab(7),h.jc("ngForOf",t.Markets),h.Ab(7),h.jc("ngForOf",t.Crops),h.Ab(13),h.jc("ngIf",t.imageUrl),h.Ab(4),h.jc("disabled",t.btnLoading||!t.cropPriceForm.valid),h.Ab(1),h.jc("ngIf",t.btnLoading))},directives:[c.a,c.d,c.b,v.a,f.a,s.t,s.j,s.e,s.q,s.p,s.i,s.d,s.m,s.u,n.j,s.b,n.k],encapsulation:2}),A),data:{roles:"KP_CALLER",title:"Crop Prices"}}]}],F=((j=function e(){i(this,e)}).\u0275fac=function(e){return new(e||j)},j.\u0275mod=h.Kb({type:j}),j.\u0275inj=h.Jb({imports:[[d.g.forChild(M)],d.g]}),j),I=((D=function e(){i(this,e)}).\u0275fac=function(e){return new(e||D)},D.\u0275mod=h.Kb({type:D}),D.\u0275inj=h.Jb({imports:[[n.c,l.a,s.o,v.b.withComponents([]),F,c.c.forRoot(),f.b.forRoot(),s.f]]}),D)}}])}();